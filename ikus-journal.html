<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iku's journal</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { display: block; }
        .title-header { text-align: center; padding: 80px 20px 40px; }
        .entry-content {
            max-height: 0; opacity: 0; overflow: hidden;
            white-space: pre-wrap; /* Keeps your paragraphs! */
            font-family: 'Georgia', serif; line-height: 1.8;
            transition: 0.6s ease;
        }
        .journal-entry.expanded .entry-content {
            max-height: 2000px; opacity: 1; margin-top: 20px;
        }
        .journal-entry.expanded { flex-basis: 100% !important; max-width: 1000px; }
    </style>
</head>
<body>
    <div class="title-header"><h1>iku's journal</h1></div>
    <div id="entries"></div>

    <div id="bottomControls">
        <a class="icon-btn" href="index.html">üè† HOME</a>
        <button id="showLoginBtn" class="lock-btn">üîí</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyBdkI7GUPRJsxLtBlp9gaQNlR7nz-JDi2g", 
            authDomain: "iku-website-iku.firebaseapp.com",
            databaseURL: "https://iku-website-iku-default-rtdb.asia-southeast1.firebasedatabase.app", 
            projectId: "iku-website-iku" 
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        onValue(ref(db, 'entries'), (snapshot) => {
            const list = document.getElementById('entries');
            list.innerHTML = '';
            const data = snapshot.val();
            if (data) {
                Object.keys(data).reverse().forEach(key => {
                    const entry = data[key];
                    const div = document.createElement('div');
                    div.className = 'journal-entry';
                    div.innerHTML = `
                        <div style="font-weight:bold; font-size:1.4rem;">${entry.text.split('\n')[0]}</div>
                        <div style="opacity:0.3; font-size:0.8rem;">${new Date(entry.date).toLocaleDateString()}</div>
                        <div class="entry-content">${entry.text.split('\n').slice(1).join('\n')}</div>
                    `;
                    div.onclick = () => {
                        div.classList.toggle('expanded');
                        if(div.classList.contains('expanded')) {
                            setTimeout(() => div.scrollIntoView({behavior:'smooth', block:'start'}), 100);
                        }
                    };
                    list.appendChild(div);
                });
            }
        });
    </script>
</body>
</html>
